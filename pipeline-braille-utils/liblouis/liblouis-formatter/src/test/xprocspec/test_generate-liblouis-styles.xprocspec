<?xml version="1.0" encoding="UTF-8"?>
<x:description xmlns:x="http://www.daisy.org/ns/xprocspec"
               xmlns:c="http://www.w3.org/ns/xproc-step"
               xmlns:pxi="http://www.daisy.org/ns/pipeline/xproc/internal"
               xmlns:louis="http://liblouis.org/liblouis"
               script="test_generate-liblouis-styles.xpl">
  
  <x:scenario label="test_01">
    <x:call step="pxi:test-generate-liblouis-styles">
      <x:input port="source">
        <x:document type="inline">
          <doc>
            <body style="display: block">
              <section style="display: block; page-break-before: always">
                <h style="display: block; left: 3; right: 3; margin-top: 1; margin-bottom: 1; text-align: center; page-break-after: avoid">
                  baz
                </h>
                <p style="display: block; text-indent: 2; orphans: 2">
                  <span style="display: inline">foo</span>bar
                </p>
              </section>
            </body>
            <louis:page-layout>
              <c:param-set>
                <c:param name="louis:braille-page-format" value="prefix-p"/>
              </c:param-set>
            </louis:page-layout>
          </doc>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <doc>
          <body louis:style="#d799e3">
            <section louis:style="#d799e5">
              <h louis:style="#d799e7">
                baz
              </h>
              <p louis:style="#d799e10">
                <span>foo</span>bar
              </p>
            </section>
          </body>
          <louis:page-layout>
            <c:param-set>
              <c:param name="louis:braille-page-format" value="prefix-p"/>
            </c:param-set>
          </louis:page-layout>
        </doc>
      </x:document>
    </x:expect>
    <x:context label="secondary">
      <x:document type="port" port="secondary"/>
    </x:context>
    <x:expect label="secondary" type="compare">
      <x:document type="inline">
        <louis:styles># --------------------------------------------------------------------------------------------------
# root
# --------------------------------------------------------------------------------------------------
style root
   braillePageNumberFormat p

# --------------------------------------------------------------------------------------------------
# d799e3
# --------------------------------------------------------------------------------------------------
style d799e3

# --------------------------------------------------------------------------------------------------
# d799e5
# --------------------------------------------------------------------------------------------------
style d799e5
   newPageBefore yes

# --------------------------------------------------------------------------------------------------
# d799e7
# --------------------------------------------------------------------------------------------------
style d799e7
   format centered
   leftMargin 3
   rightMargin 3
   linesBefore 1
   linesAfter 1
   keepWithNext yes

# --------------------------------------------------------------------------------------------------
# d799e10
# --------------------------------------------------------------------------------------------------
style d799e10
   firstLineIndent 2
   orphanControl 2

</louis:styles>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <x:scenario label="test_02">
    <x:call step="pxi:test-generate-liblouis-styles">
      <x:input port="source">
        <x:document type="inline">
          <louis:toc href="file:/home/me/doc.xml" width="20">
            <louis:toc-item style="display: toc-item; left: 4; text-indent: -4"/>
            <louis:toc-item style="display: toc-item; left: 4; text-indent: -4"/>
            <louis:toc-item style="display: toc-item; left: 6; text-indent: -4"/>
          </louis:toc>
        </x:document>
        <x:document type="inline">
          <doc xml:base="file:/home/me/doc.xml">
            <louis:page-layout>
              <c:param-set>
                <c:param name="louis:page-width" value="30"/>
              </c:param-set>
            </louis:page-layout>
          </doc>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <louis:toc href="file:/home/me/doc.xml" width="20">
          <louis:toc-item louis:style="#d865e3"/>
          <louis:toc-item louis:style="#d865e3"/>
          <louis:toc-item louis:style="#d865e7"/>
        </louis:toc>
      </x:document>
    </x:expect>
    <x:context label="secondary">
      <x:document type="port" port="secondary"/>
    </x:context>
    <x:expect label="secondary" type="compare">
      <x:document type="inline">
        <louis:styles># --------------------------------------------------------------------------------------------------
# contents1
# --------------------------------------------------------------------------------------------------
style contents1
   format contents
   leftMargin 14
   firstLineIndent -4

# --------------------------------------------------------------------------------------------------
# contents2
# --------------------------------------------------------------------------------------------------
style contents2
   format contents
   leftMargin 16
   firstLineIndent -4

</louis:styles>
      </x:document>
    </x:expect>
  </x:scenario>
  
</x:description>
